{% extends "graphwhy:templates/layout.jinja2" %}

{% block content %}

    <form action="{{request.route_url('question_action',action=action)}}" method="post" class="form">
        <h3 class="sg-p-color">Question</h3>
        <p class="sg-p-color">Enter a <b>question</b> to contribute to our list.</p>    <!-- CUSTOM ERROR REGISTRATION FOR NON-UNIQUE ENTRIES -->
        {% if action =='edit' %}
            {{ form.id() }}
        {% endif %}
        {# Question form #}
        <div class="form-group">

            {# question prompt form #}
            <label for="title" class="sg-a1-color">{{ form.question.label }}</label>
            {% for error in form.question.errors %}
                <div class="alert alert-danger">{{ error }}</div>
            {% endfor %}
            {{ form.question(class_='form-control') }}

            {# Type form #}
            <label for="body" class="sg-a1-color">{{ form.type.label }}</label>
            {% for error in form.type.errors %}
                <div class="alert alert-danger">{{ error }}</div>
            {% endfor %}
            {{ form.type(class_='form-control') }}

            {# Description form #}
            <label for="body" class="sg-a1-color">{{ form.description.label }}</label>
            {% for error in form.description.errors %}
                <div class="alert alert-danger">{{ error }}</div>
            {% endfor %}
            {{ form.description(class_='form-control', value_='hi') }}

            {# Question options form #}
            <label for="body" class="sg-a1-color">{{ form.question_option.entries[0].question_option.label }}</label>
            {% for error in form.question_option.errors %}
                <div class="alert alert-danger">{{ error }}</div>
            {% endfor %}
            
            <ol>
                {% if form.question_option.type == 'FieldList' %}
                    {% for subfield in form.question_option.entries %}
                        <li> 
                            {{ subfield.question_option(class_='form-control', value_='hi') }}
                        </li>
                    {% endfor %}
                {% endif %}
                <inserthere id="options"></inserthere>
            </ol>
            <div class="voter-bar" style="margin-left:40px;padding: 0px 9px;">
                <a onclick="removeOption()" style="cursor:pointer;"> - </a>   
            </div>
            <div class="voter-bar" style="margin-left:5px;">
                <a onclick="appendOption()" style="cursor:pointer;"> + </a>       
            </div>
        </div>

        <div class="form-group">
            <label></label>
            <button type="submit" class="btn btn-default" style="width:100%;" >Submit</button>
        </div>
    </form>
        
    <script>    
       iPrime = 2;
       function appendOption() {
          var newItem = document.createElement("LI");
          newItem.setAttribute("id", "item" + iPrime);
          var optionTextArea = document.createElement("textarea");
          optionTextArea.className = "form-control";
          optionTextArea.setAttribute("name", "question_option-"+iPrime+"-question_option");
          optionTextArea.setAttribute("id", "question_option-"+iPrime+"-question_option");
          newItem.appendChild(optionTextArea);

          var list = document.getElementById("options");
          list.insertBefore(newItem, list.childNodes[iPrime++]);
       }
       function removeOption() {
          console.log("clicked");
          if(iPrime > 2){
              iPrime--;
              var oldForm = document.getElementById("question_option-"+iPrime+"-question_option");
              var oldItem = document.getElementById("item" + iPrime);
              oldForm.remove();
              oldItem.remove();
          }
       }
    </script>



{% endblock %}
